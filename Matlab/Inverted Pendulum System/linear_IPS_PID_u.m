dq_fun = @difeq_IPS_PID;
tspan = [0:0.01:5];
z0 = [1;0;pi/3;0;0];
m = 0.1;
M = 2;
l = 0.5;
g = 9.8;
A = [0,1,0,0;
    0,0,-m*g/M,0;
    0,0,0,1;
    0,0,(m+M)*g/(M*l),0];
B = [0;1/M;0;-1/(M*l)];
Kp = 100;
Kd = 20;
Ki = 70;
[t,z] = ode45(dq_fun,tspan,z0,[],A,B,Kp,Kd,Ki);
u = [Kp,Kd,Ki]*z(:,3:5)';
plot(t,u,'linewidth',2);
xlabel('Time');
ylabel('Force');
title('Input Force of Linearized Inverted Pendulum System with PID Control');
grid on;
grid minor;