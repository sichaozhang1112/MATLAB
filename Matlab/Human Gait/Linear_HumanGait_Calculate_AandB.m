% Calculate A & B
% Parameters
m_1 = 7.994;
l_1 = 0.4;
l_c1 = 0.173;
I_1 = 0.133;
m_2 = 3.717;
l_2 = 0.435;
l_c2 = 0.188;
I_2 = 0.064;
m_3 = 1.159;
l_c3 = 0.116;
I_3 = 0.010;
g = 9.81;

d = zeros(3,3);
d(1,1) = I_1 + m_1 * l_c1 * l_c1 + m_2 * l_1 * l_1 + m_3 * l_1 * l_1 ;
d(1,2) = (m_2 * l_1 * l_c2 + m_3 * l_1 * l_2 );
d(1,3) = m_3 * l_1 * l_c3;
d(2,1) = m_2 * l_1 * l_c2 + m_3 * l_1 * l_2;
d(2,2) = I_2 + m_2 * l_c2 * l_c2 + m_3 * l_2 * l_2;
d(2,3) = m_3 * l_2 * l_c3;
d(3,1) = m_3 * l_1 * l_c3;
d(3,2) = m_3 * l_2 * l_c3;
d(3,3) = I_3 + m_3 * l_c3 * l_c3;

h = zeros(3,1);
h(1,1) = m_1 * g * l_c1 + m_2 * g * l_1 + m_3 * g * l_1;
h(2,1) = m_2 * g * l_c2 + m_3 * g * l_2;
h(3,1) = m_3 * g * l_c3;

a = zeros(3,3);
a(1,1) = (d(2,2)*d(3,3) - d(2,3)*d(3,2)) * h(1,1) / det(d);
a(1,2) = (- d(2,3)*d(3,1) + d(2,1)*d(3,3)) * h(2,1) / det(d);
a(1,3) = (d(2,1)*d(3,2) + d(2,2)*d(3,1)) * h(3,1) / det(d);
a(2,1) = (- d(1,2)*d(3,3) + d(1,3)*d(3,2)) * h(1,1) / det(d);
a(2,2) = (d(1,1)*d(3,3) - d(1,3)*d(3,1)) * h(2,1) / det(d);
a(2,3) = (- d(1,1)*d(3,2) + d(1,2)*d(3,1)) * h(3,1) / det(d);
a(3,1) = (d(1,2)*d(2,3) - d(1,3)*d(2,2)) * h(1,1) / det(d);
a(3,2) = (- d(1,1)*d(2,3) + d(1,3)*d(2,1)) * h(2,1) / det(d);
a(3,3) = (d(1,1)*d(2,2) - d(1,2)*d(2,1)) * h(3,1) / det(d);

b = zeros(3,3);
b(1,1) = (d(2,2)*d(3,3) - d(2,3)*d(3,2)) / det(d);
b(1,2) = (- d(2,3)*d(3,1) + d(2,1)*d(3,3)) / det(d);
b(1,3) = (d(2,1)*d(3,2) + d(2,2)*d(3,1)) / det(d);
b(2,1) = (- d(1,2)*d(3,3) + d(1,3)*d(3,2)) / det(d);
b(2,2) = (d(1,1)*d(3,3) - d(1,3)*d(3,1)) / det(d);
b(2,3) = (- d(1,1)*d(3,2) + d(1,2)*d(3,1)) / det(d);
b(3,1) = (d(1,2)*d(2,3) - d(1,3)*d(2,2)) / det(d);
b(3,2) = (- d(1,1)*d(2,3) + d(1,3)*d(2,1)) / det(d);
b(3,3) = (d(1,1)*d(2,2) - d(1,2)*d(2,1)) / det(d);






